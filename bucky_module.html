<!DOCTYPE html>
<head>
</head>
<body style="overflow: hidden;"  onload="page_load()" oncontextmenu="return false;">

<canvas onmousemove="mouse_move(event)" onmousedown="mouse_press(event)" id="draw_canvas" width="1000" height="600" tabindex="1"></canvas>

<textarea id="MapOutput" style="width: 400px; height: 150px;">Map Output</textarea>

<script type="text/javascript">
  	document.getElementById("draw_canvas").focus();
	Canvas = 			document.getElementById("draw_canvas").getContext("2d");
	physExecuteMs = 	7;
</script>

<script src="setup.js"></script>
<script src="preloader.js"></script>

<script type="text/javascript">
Preloader.ready(function(){
	console.log("Preloader finished: Beginning game...");
	begin_game();
});

Preloader.addImage(["images/grass_tileset/grass_single.png", "images/grass_tileset/grass_bottom_single.png", "images/grass_tileset/grass_right_single.png", "images/grass_tileset/grass_bottom_right.png", "images/grass_tileset/grass_left_single.png", "images/grass_tileset/grass_bottom_left.png", "images/grass_tileset/grass_middle_single_horizontal.png", "images/grass_tileset/grass_bottom_middle.png", "images/grass_tileset/grass_top_single.png", "images/grass_tileset/grass_middle_single_vertical.png", "images/grass_tileset/grass_top_right.png", "images/grass_tileset/grass_middle_right.png", "images/grass_tileset/grass_top_left.png", "images/grass_tileset/grass_middle_left.png", "images/grass_tileset/grass_top_middle.png", "images/grass_tileset/ground_tile.png"]);
</script>



<script src="elements.js"></script>
<script src="tileset.js"></script>
<script src="layer.js"></script>
<script src="scene.js"></script>
<script src="newmap.js"></script>

<script type = "text/javascript">

function mouse_move(event) {}
function mouse_press(event) {}
function key_event(event) {}
function key_event_up(event) {}
function mouse_up(event) {}
function mouse_down(event) {}
function mouse_scroll(event) {}

function page_load() {
	var mousewheelevt=(/Firefox/i.test(navigator.userAgent))? "DOMMouseScroll" : "mousewheel";
	if (document.attachEvent){
		document.attachEvent("on"+mousewheelevt, function(e) {mouse_scroll(e)}, false);
	}else if (document.addEventListener){
		document.addEventListener(mousewheelevt, function(e) {mouse_scroll(e)}, false);
	}
}

function begin_game() {

	

	GrassTileset = new Tileset(
		"Grass", 
		["images/grass_tileset/grass_single.png", "images/grass_tileset/grass_bottom_single.png", "images/grass_tileset/grass_right_single.png", "images/grass_tileset/grass_bottom_right.png", "images/grass_tileset/grass_left_single.png", "images/grass_tileset/grass_bottom_left.png", "images/grass_tileset/grass_middle_single_horizontal.png", "images/grass_tileset/grass_bottom_middle.png", "images/grass_tileset/grass_top_single.png", "images/grass_tileset/grass_middle_single_vertical.png", "images/grass_tileset/grass_top_right.png", "images/grass_tileset/grass_middle_right.png", "images/grass_tileset/grass_top_left.png", "images/grass_tileset/grass_middle_left.png", "images/grass_tileset/grass_top_middle.png", "images/grass_tileset/ground_tile.png"], 
		"full", 
		true
	);

	Materials.defineTileset(GrassTileset);
	Materials.defineTile(Materials.getTileset("Grass"), 25, 25, 0, 0);


	BuckyGame = new Scene(map, 25);

	caller();	// start the physics and drawing loops to start game
}

function caller(){
	physInterval = setInterval(physics, physExecuteMs);
	draw_world();
}

function physics(){

}

function stats() {

	/******************************************
	 GENERATE SOME STATISTICS FOR SHOWING ONSCREEN
	 ******************************************/
	 // currently unused, replaced by canvas infobox.
}


function draw_world() { 

	/******************************************
	 GRAPHICS TIMER, USED FOR STATS DISPLAY
	 ******************************************/

	BuckyGame.draw();

	animId = window.requestAnimationFrame(draw_world);

}


window.addEventListener('keydown', 	 key_event,		true);
window.addEventListener('keyup', 	 key_event_up,	true);
window.addEventListener('mouseup', 	 mouse_up, 		false);
window.addEventListener('mousedown', mouse_down, 	false);

</script> 


</body>
</html>

