<!DOCTYPE html>
<head>

<script src="setup.js"></script>
<script src="elements.js"></script>
<script src="layer.js"></script>
<script src="scene.js"></script>
<script src="newmap.js"></script>

<script type = "text/javascript">

/////////// performance.now() shim

window.performance = window.performance || {};
performance.now = (function() {
  return performance.now       ||
         performance.mozNow    ||
         performance.msNow     ||
         performance.oNow      ||
         performance.webkitNow ||
         function() { return new Date().getTime(); };
})();


function mouse_move(event) {}
function mouse_press(event) {}
function key_event(event) {}
function key_event_up(event) {}
function mouse_up(event) {}
function mouse_down(event) {}
function mouse_scroll(event) {}

var ctx;
var physExecuteMs = 	7;



function page_load() {
	var mousewheelevt=(/Firefox/i.test(navigator.userAgent))? "DOMMouseScroll" : "mousewheel";
	if (document.attachEvent){
		document.attachEvent("on"+mousewheelevt, function(e) {mouse_scroll(e)}, false);
	}else if (document.addEventListener){
		document.addEventListener(mousewheelevt, function(e) {mouse_scroll(e)}, false);
	}

	begin_game();
}

function begin_game() {

	var canvas = document.getElementById("draw_canvas");
	ctx = canvas.getContext("2d");

	BuckyGame = new Scene(map);

	caller();	// start the physics and drawing loops to start game
}

function caller(){
	physInterval = setInterval(physics, physExecuteMs);
	draw_world();
}

function physics(){

}

function stats() {

	/******************************************
	 GENERATE SOME STATISTICS FOR SHOWING ONSCREEN
	 ******************************************/
	 // currently unused, replaced by canvas infobox.
}


function draw_world() { 

	/******************************************
	 GRAPHICS TIMER, USED FOR STATS DISPLAY
	 ******************************************/

	animId = window.requestAnimationFrame(draw_world);

}


window.addEventListener('keydown', 	 key_event,		true);
window.addEventListener('keyup', 	 key_event_up,	true);
window.addEventListener('mouseup', 	 mouse_up, 		false);
window.addEventListener('mousedown', mouse_down, 	false);

</script> 
</head>
<body style="overflow: hidden;"  onload="page_load()" oncontextmenu="return false;">

<canvas onmousemove="mouse_move(event)" onmousedown="mouse_press(event)" id="draw_canvas" width="1000" height="600" tabindex="1"></canvas>

<textarea id="MapOutput" style="width: 400px; height: 150px;">Map Output</textarea>

<script type="text/javascript">
	gameCanvas = document.getElementById("draw_canvas");
  	document.getElementById("draw_canvas").focus();
</script>

</body>
</html>

